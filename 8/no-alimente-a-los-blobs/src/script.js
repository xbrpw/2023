
//	BLOB SVG

let bloop = `<svg class="blob" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.41421" clip-rule="evenodd" viewBox="0 0 173 121">
<g id="Blob">
<path id="FlubThree" fill="#d5ff00" fill-opacity=".615686" d="M44.848 14.424C26.397 32.27 25.444 42.552 19.481 63.302c-4.182 14.554-9.687 26.34-3.681 39.155 5.717 12.199 33.923 11.842 46.217 10.601 25.428-2.565 33.157.294 47.92 1.667 23.9 2.223 41.07 6.331 50.746-4.823 18.827-21.705 12.093-26.598-3.292-63.142C136.155-3.685 59.89-.123 44.848 14.424z"/>
<path id="FlubTwo" fill="#d5ff00" fill-opacity=".615686" d="M37.585 19.565C19.351 37.2 18.409 47.361 12.517 67.866c-4.133 14.382-9.573 26.029-3.638 38.693 5.65 12.055 33.891 7.264 45.673 10.477 18.361 5.006 31.128 3.919 47.354 1.647 23.491-3.29 40.586 6.256 50.148-4.767 18.605-21.448 8.783-29.574-.993-68.007C137.728-6.509 52.449 5.189 37.585 19.565z"/>
<path id="FlubOne" fill="#d5ff00" fill-opacity=".615686" d="M37.463 15.204C19.229 32.84 12.149 36.348 6.257 56.852c-4.133 14.383-9.573 26.03-3.638 38.694 5.65 12.055 33.523 11.702 45.672 10.476 25.129-2.535 32.766.29 47.355 1.647 23.618 2.197 40.586 6.257 50.148-4.766 18.605-21.449 8.783-29.574-.993-68.007C131.467-17.522 52.327.829 37.463 15.204z"/>
<path class="reflections" fill="#fff" d="M133.929 24.607c.141-.187.151-.442.025-.639-2.021-3.104-5.391-5.521-8.925-6.679-.428-.137-.893.049-1.108.444l.056.03c-.064.143-.067.305-.009.45.057.145.171.261.315.321 3.321 1.447 6.075 3.421 8.3 6.098.166.204.416.319.678.314.262-.005.508-.131.665-.34l.003.001zM16.367 72.119c-.226-.061-.466.025-.602.216-2.123 3.034-3.106 7.064-2.858 10.775.032.448.379.809.825.861l.007-.063c.157.006.308-.052.421-.16.113-.107.178-.256.18-.412.101-3.621.903-6.914 2.554-9.978.126-.23.14-.505.037-.746-.103-.241-.311-.422-.564-.49.001-.003 0-.003 0-.003zM141.23 108.7c.18.15.434.173.638.058 3.204-1.859 5.791-5.1 7.129-8.57.16-.42-.002-.894-.386-1.128l-.033.053c-.139-.07-.301-.082-.449-.032-.147.05-.269.158-.337.298-1.615 3.243-3.729 5.891-6.517 7.975-.212.155-.34.399-.348.661-.009.263.104.514.305.682l-.002.003z"/>
<g id="EyeOne">
<path d="M60.313 55.327c8.295.157 14.902 7.019 14.745 15.314-.157 8.295-7.019 14.902-15.314 14.745-8.295-.157-14.902-7.019-14.745-15.314.158-8.295 7.019-14.902 15.314-14.745z"/>
<path fill="#fff" d="M52.97 63.63c1.182.023 2.125 1.001 2.102 2.184-.022 1.183-1.001 2.125-2.184 2.102-1.182-.022-2.125-1-2.102-2.183.022-1.183 1.001-2.125 2.184-2.103zM55.231 61.457c.535.01.961.453.951.988-.011.535-.453.961-.988.951-.535-.01-.961-.453-.951-.988.01-.535.452-.961.988-.951z"/>
</g>
<g id="EyeTwo">
<path d="M105.302 89.107c-11.496 2.849-23.141-4.172-25.989-15.668-2.848-11.496 4.173-23.141 15.668-25.99 11.496-2.848 23.142 4.173 25.99 15.669 2.848 11.496-4.173 23.141-15.669 25.989z"/>
<path fill="#fff" d="M112.361 74.945c-1.639.406-3.3-.595-3.706-2.234-.406-1.64.595-3.3 2.234-3.706 1.639-.407 3.3.595 3.706 2.234.406 1.639-.595 3.3-2.234 3.706zM110.046 78.777c-.741.183-1.493-.27-1.676-1.011-.184-.741.269-1.493 1.01-1.676.742-.184 1.493.269 1.677 1.01.183.742-.269 1.493-1.011 1.677z"/>
</g>
</g>
</svg>`

let cookie = `<div class="cookie"><svg xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.41421" clip-rule="evenodd" viewBox="0 0 212 219">
<g id="Cookie">
<path fill="#c3ac70" d="M110.087.051C78.96.051 43.408 16.434 21.98 42.796 9.872 57.69 9.413 72.271 5.534 90.076.206 114.531.367 139.073 8.96 163.744c9.941 28.539 54.837 52.317 83.293 54.006 62.022 3.684 77.541-7.751 92.293-25.801 12.897-15.781 18.433-31.302 23.172-50.822 5.246-21.618 6.903-66.247-5.886-85.853C164.342-2.204 110.087.051 110.087.051z"/>
<path fill="#7c7667" d="M97.031.822C88.83 2.145 54.5 9.016 35.322 27.154-2.956 63.357-5.675 112.678 6.317 161.553c4.556 18.566 38.874 44.527 59.656 50.93 31.127 9.59-5.492-3.025-19.793-25.809-10.737-17.104-20.79-30.625-23.404-49.687-2.859-20.847-1.976-50.953 11.146-66.682C47.441 54.1 67.476 21.872 86.387 12.14c19.746-10.162 57.071-7.263 36.875-11.105C112.409-1.03 98.447.594 97.031.822z"/>
<path fill="#988e74" d="M100.672 3.684s-34.179 7.691-54.036 25.68C8.262 64.128 4.428 113.952 16.214 161.986c4.477 18.246 32.704 45.26 53.129 51.553 30.591 9.425.103-4.473-13.953-26.865-10.551-16.81-20.432-30.098-23.001-48.832-2.809-20.487-5.942-56.075 6.955-71.533 13.286-15.927 36.976-41.6 55.561-51.164 19.407-9.988 13.411-6.544 33.135-10.923 8.749-1.942-5.952-1.033-17.753-.553-5.763.235-10.198.367-9.615.015z"/>
<path fill="#3b3934" d="M31.305 100.201c0-.365-2.143 1.503-2.227 1.617-1.101 1.494-1.646 3.5-2.094 5.274-1.287 5.103-.298 11.319 1.301 16.23 3.743 11.498 17.983 16.859 27.719 9.172 1.42-1.121 2.657-2.466 3.582-4.023 8.327-14.014-14.748-17.095-23.07-20.559-2.672-1.112-5.211-7.711-5.211-7.711zM109.789 56.143s-39.026 8.451-2.02 28.66c3.9 2.129 15.395 3.385 14.856-3.887-.71-9.58-5.183-19.104-12.836-24.773zM137.996 131.412s-3.611 15.279-3.555 18.899c.356 22.771 36.357 12.385 29.055-6.621-.947-2.466-2.429-4.802-4.285-6.684-2.405-2.438-5.577-4.131-8.805-5.207-4.076-1.359-8.258-1.438-12.41-.387zM172.305 57.416s-10.604 14.052-9.739 19.016c1.346 7.721 8.87 8.69 12.676 1.914.942-1.677 1.624-3.5 2.031-5.379.557-2.569.599-5.256.016-7.824-.698-3.075-2.524-5.776-4.984-7.727zM114.496 194.221s-54.131 13.708-35.031 19.961c7.271 2.38 38.487 6.014 44.578 1.316 9.481-7.312-.139-15.612-9.547-21.277zM97.305 4.701c-8.331 0-16.357 11.112-11.274 18.625 2.911 4.304 9.491 5.145 14.223 5.145 6.609 0 15.07-2.315 19.523-7.543.908-1.066 1.788-2.505 2.254-4.015.553-1.794.52-3.689-.746-5.177-4.634-5.444-23.98-7.035-23.98-7.035z"/>
</g>
</svg> </div>`


//	HELPERS
randomRGB = () => {
	let r = Math.floor(Math.random() * 155) + 100;	
	let g = Math.floor(Math.random() * 155) + 100;
	let b = Math.floor(Math.random() * 155) + 100;
	return `rgb(${r},${g},${b})`;
}

let colors = randomColor({luminosity: 'light',count: 120});

randomBetween = (min, max) => {
	return Math.floor(Math.random() * max) + min;
}

//	Eat Cookies
eat = (blob) => {
	TweenMax.to(blob, .5, {
		width: '+=12',
		ease: Elastic.easeOut.config(1, 0.4)
	})

	TweenMax.to($('#EyeOne, #EyeTwo', blob), 5, {
		transformOrigin: '50% 50%',
		rotation: '+=720',
		ease: Elastic.easeOut.config(1, 0.3)
	})	
}
let $allBlobs;
spawnBlobs = (amount) => {

	$roomWidth = $(document).width();
	$roomHeight = $(document).height();
	$blobs = $('.blobs');

	//	Random position, random color
	for (let k = 0; k < amount; k++) {
		$blobs.append(bloop);
		$newBlob = $('.blob:last-child', $blobs);
		$floobs = $('#FlubOne, #FlubTwo, #FlubThree', $newBlob);
		$reflections = $('.reflections');
		$newBlob.css({
			width: randomBetween(60, 100) + 'px',
			left: randomBetween(50, $roomWidth - 200),
			top: randomBetween(50, $roomHeight - 200),
		});
		
		
		$floobs.css({
			fill: colors[Math.floor(Math.random() * colors.length)]
		})
		
		// add reflections to selection
		$floobs = $('#FlubOne, #FlubTwo, #FlubThree, .reflections', $newBlob);

		// Blob Squish
		TweenMax.from($($floobs, $newBlob), .5, {
			transformOrigin: '50% 100%',
			scaleX: 1.08,
			repeat:-1,
			yoyo:true,
			delay: Math.random() * 2,
		})
	}
	$allBlobs = $('.blob');
}

//	Spawn Cookies
spawnCookie = (pos) => {
	$food = $('.food').append(cookie);
	let randomRotation = `rotate(${randomBetween(0,360)}deg)`
	$cookie = $('.cookie:last-child', $food);
	$cookie.css({
		width: randomBetween(15,22),
		top: pos.y - $cookie.height()/2,
		left: pos.x - $cookie.width()/2,
		transform: randomRotation,
	});
}

$(document).on('click', (e) => {
	let position = {
		x: e.clientX,
		y: e.clientY
	}
	spawnCookie(position);
})



setInterval(() => {
	$allBlobs.each((index,blob) => {
		let blobPos = {
			x: $(blob).position().left + ($(blob).width()/2),
			y: $(blob).position().top + ($(blob).height()/2),
		}

		let closestFood = {
			distance: 999999
		};

		$('.cookie').each((i,food) => {
			let foodPos = {
				x: $(food).position().left + ($(food).width()/2),
				y: $(food).position().top + ($(food).height()/2),
			}

			let xDiff = foodPos.x - blobPos.x;
			let yDiff = foodPos.y - blobPos.y;
			let distance = Math.sqrt(yDiff * yDiff + xDiff * xDiff);
			let direction = {x: xDiff/distance, y: yDiff/distance};

			if (distance < closestFood.distance) {
				closestFood.item = $(food);
				closestFood.direction = direction;
				closestFood.distance = distance;
			}
		})

		//	Go to closest Cookie
		if (closestFood.direction) {
			TweenMax.to($(blob), 6, {
				x: '+=' + closestFood.direction.x * $(blob).width(),
				y: '+=' + closestFood.direction.y * $(blob).width(),
				// ease: Power1.easeIn
			})	

			if (closestFood.distance < $(blob).width() * .4) {
				closestFood.item.remove();
				eat($(blob))
			}
		}
	})
},350) 

//	SPAWN BLOBS
spawnBlobs(13);